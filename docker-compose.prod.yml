services:
  backend:
    build:
      context: ./backend
      dockerfile: Dockerfile.dev
    command: >
      sh -c "
      python manage.py flush --no-input &&
      python manage.py makemigrations &&
      python manage.py migrate &&
      daphne -p 8000 -b 0.0.0.0 freelancenowbackend.asgi:application"

    environment:
      - DJANGO_SETTINGS_MODULE=freelancenowbackend.settings
    ports:
      - 29000:8000
  frontend:
    build:
      context: ./frontend
      dockerfile: Dockerfile.dev
    command: npm run dev  
    ports:
      - "29002:5173"
      - "29003:5173"
    depends_on:
      - backend
    environment:
      - NODE_ENV=prod
    stdin_open: true

